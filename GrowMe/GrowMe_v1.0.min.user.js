// ==UserScript==
// @name         Растишка
// @version      1.0.min
// @description  Растишка. ПРИ ВЫПОЛНЕНИИ НЕ СИДИТЕ НА СТРАНИЦЕ, ОТ ЭТОГО СКРИПТ ТОРМОЗИТ! И НЕ ЗАХОДИТЕ К ДРУГИМ ЛОШАДЯМ!
// @namespace    http://tampermonkey.net/
// @author       4eDo (https://github.com/4eDo/lowadi)
// @match        https://www.lowadi.com/elevage/chevaux/*
// ==/UserScript==
function pause(n){return Math.floor(Math.random()*81)+120+n}function feed(){if(chevalAge>4){var n=$(".float-right.section-fourrage.section-fourrage-quantity").text().trim().split(" / "),t=+n[1],i=+n[0];if($("#care-tab-feed #messageBoxInline").text().indexOf("недостаточный")!==-1&&(t=20-i),$("#haySlider li:eq("+(t-i)+")").click(),chevalAge>16){var r=$(".float-right.section-avoine.section-avoine-quantity").text().trim().split(" / "),u=+r[1],f=+r[0];$("#oatsSlider li:eq("+(u-f)+")").click()}setTimeout(function(){$("#feed-button").click()},pause(0))}else $("#boutonAllaiter").click()}function grow(){growButton==0&&($('#night-wrapper button:contains("Подтвердить")').click(),growButton=1)}function needWash(){return $("#boutonPanser").hasClass("action-disabled")||doWash!=1?!1:!0}function needFeed(){if(doEat!=1)return!1;var n=$(".float-right.section-fourrage.section-fourrage-quantity").text().trim().split(" / "),t=+n[1],i=+n[0],r=$(".float-right.section-avoine.section-avoine-quantity").text().trim().split(" / "),u=+r[1],f=+r[0];return chevalAge<6&&doMilk==1?$("#boutonAllaiter").hasClass("action-disabled")?!1:!0:chevalAge>17?i>=t&&f>=u||$("#care-tab-feed #messageBoxInline").text().indexOf("толст")!==-1?!1:!0:chevalAge<6?!1:i>=t||$("#care-tab-feed #messageBoxInline").text().indexOf("толст")!==-1?!1:!0}function needLesson(){return doLesson!=1?!1:chevalAge>23&&+$("#energie").text()-+$("#mission-wrapper").html().substr($("#mission-wrapper").html().indexOf("Энергия"),45).replace(/[^,0-9]/gim,"").replace(/[,]/gim,".")>20?$("#mission").text().indexOf("недостаточно энергии")!==-1?!1:$("#mission-wrapper a").hasClass("action-disabled")?!1:!0:!1}function needSleep(){return $("#boutonCoucher").hasClass("action-disabled")||doSleep!=1?!1:!0}function progon(){location.href.indexOf("chevaux/cheval?id")!==-1?chevalAge<maxAge?needWash()?$("#boutonPanser").click():needLesson()?$("#mission-wrapper a").click():needFeed()?feed():needSleep()?$("#boutonCoucher").click():grow():(alert("Возраст максимален!"),clearTimeout(mainSet),clearTimeout(checkSet),localStorage.setItem("stopGrow",1),localStorage.setItem("isOptGrow",0)):location.href.indexOf("/elevage/chevaux/?elevage=")!==-1&&(history.go(-1),pause(6e5))}var growButton,checkSet,mainSet;if($("body#global").append('<div class="stopMe" style="display:block;color:#ffffff;position:fixed;width: 100px;height: 20px;top: 30px;padding: 5px;left: 10px;background-color:rgba(128, 0, 0, 0.9);z-index:990;border-radius: 4px;"><center><button id="noGrow" type="button"> ОСТАНОВИТЬ <\/button><\/center><\/div>'),$("#noGrow").click(function(){localStorage.setItem("stopGrow",0);localStorage.setItem("isOptGrow",0);document.title="П Р Е К Р А Щ А Ю";location.reload();alert("Выращивание лошади прервано.")}),localStorage.getItem("isOptGrow")==1)var selYY=localStorage.getItem("inpYYgr"),selMM=localStorage.getItem("inpMMgr"),doLesson=localStorage.getItem("inpLessGr"),doEat=localStorage.getItem("inpEat"),doWash=localStorage.getItem("inpWash"),doSleep=localStorage.getItem("inpSleep"),maxAge=parseInt(parseInt(selYY*12)+parseInt(selMM));else document.title="З А В Е Р Ш Е Н О",$("body#global").append('<div class="growPanel" style="display:block;color:#ffffff;position:fixed;width: 400px;height: 200px;top: 50%;margin-top: -100px;margin-left: -200px;padding: 20px;left: 50%;background-color:rgba(0, 0, 0, 0.9);z-index:990;border-radius: 4px;"><\/div>'),$(".growPanel").append('<center><p style="z-index:999;color:#ffffff; font-size: 13px; font-family: Arial,Helvetica,sans-serif;text-shadow: 1px 1px 2px #778899;margin-top:5px;"><b>Настройки<\/b><\/p><\/center><\/br>'),$(".growPanel").append('<p>До скольки растить: <input id="inpYYgr" type="number" min="0" value="0">лет  <input id="inpMMgr" type="number" min="0" value="0">мес. <\/p>'),$(".growPanel").append('<p>Урок: <select id="inpLessGr" style=" "><option value="1">\tВключён\t\t<\/option><option value="0">\tВыключен\t<\/option><\/select><\/p>'),$(".growPanel").append('<p>Корм: <select id="inpEat" style=" "><option value="1">\tВключён\t\t<\/option><option value="0">\tВыключен\t<\/option><\/select><\/p>'),$(".growPanel").append('<p>Чистка: <select id="inpWash" style=""><option value="1">\tВключён\t\t<\/option><option value="0">\tВыключен\t<\/option><\/select><\/p>'),$(".growPanel").append('<p>Сон: <select id="inpSleep" style=" "><option value="1">\tВключён\t\t<\/option><option value="0">\tВыключен\t<\/option><\/select><\/p>'),$(".growPanel").append('<\/br><center><button id="submGrow" type="button"> Применить и запустить <\/button><\/center>');localStorage.getItem("isOptGrow")!==null?($("#inpYYgr").val(localStorage.getItem("inpYYgr")),$("#inpMMgr").val(localStorage.getItem("inpMMgr")),$("#inpWash").val(localStorage.getItem("inpWash")),$("#inpEat").val(localStorage.getItem("inpEat")),$("#inpSleep").val(localStorage.getItem("inpSleep")),$("#inpLessGr").val(localStorage.getItem("inpLessGr"))):($("#inpYYgr").val(0),$("#inpMMgr").val(0));$("#submGrow").click(function(){localStorage.setItem("inpYYgr",$("#inpYYgr").val());localStorage.setItem("inpMMgr",$("#inpMMgr").val());localStorage.setItem("inpWash",$("#inpWash option:selected").val());localStorage.setItem("inpEat",$("#inpEat option:selected").val());localStorage.setItem("inpSleep",$("#inpSleep option:selected").val());localStorage.setItem("inpLessGr",$("#inpLessGr option:selected").val());localStorage.setItem("isOptGrow",1);alert("Настройки применены. Нажмите 'Ок', чтобы запустить скрипт.\n\n Покиньте вкладку до завершения работы скрипта (он смущается и работает медленнее). Не заходите к другим лошадям. \n\n После завершения надпись на вкладке изменится на 'Завершено'.");location.reload()});localStorage.setItem("stopGrow",0);growButton=0;checkSet=setTimeout(function run1(){growButton=0;setTimeout(run1,pause(8e3))},pause(8e3));mainSet=setTimeout(function run(){localStorage.getItem("stopGrow")==0&&progon();setTimeout(run,pause(0))},pause(0));
